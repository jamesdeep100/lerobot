# 模型实验排行榜

> **重要提示：** 启动任何新实验前，必须先阅读此表，了解当前最优配置和参数历史。

## 当前最优 (SOTA)

| 任务 | 策略 | 成功率 | 配置 | 实验编号 |
|------|------|--------|------|----------|
| PushT | Diffusion | **54%** | 100k步, h=32, a=8 | exp_006 |
| PushT | ACT | **24%** | 20k步, dim=1024, dec=4, chunk=10 | act_005 |

---

## Diffusion Policy 实验 (PushT)

| 实验ID | 日期 | 父实验 | 步数 | horizon | n_action | down_dims | 成功率 | avg_sum | avg_max | 状态 | 备注 |
|--------|------|--------|------|---------|----------|-----------|--------|---------|---------|------|------|
| exp_001 | 2026-01-10 | - | 20k | 16 | 8 | [256,512,1024] | 12% | 79.5 | 62.6% | 完成 | 基线 |
| exp_002 | 2026-01-10 | exp_001 | 50k | 16 | 8 | [256,512,1024] | 16% | 112.2 | 62.6% | 完成 | 增加步数 |
| exp_003 | 2026-01-10 | exp_001 | 20k | **32** | 8 | [256,512,1024] | 18% | 86.1 | 54.1% | 完成 | 增大 horizon |
| exp_004 | 2026-01-10 | exp_001 | 20k | 16 | **16** | [256,512,1024] | 2% | 53.6 | - | 完成 | 增加动作步数（失败）|
| exp_005 | 2026-01-10 | exp_001 | 20k | 16 | **4** | [256,512,1024] | 6% | 76.4 | 54.1% | 完成 | 减少动作步数（失败）|
| **exp_006** | 2026-01-10 | exp_003 | **100k** | **32** | 8 | [256,512,1024] | **54%** | 97.14 | 96.5% | 完成 | **🏆 最优** |

### 关键发现 (Diffusion)

1. `horizon=32` 优于 `horizon=16` (+6个百分点)
2. `n_action_steps=8` 是最优值
3. 100k步 = 125个epoch，相比20k步有显著提升

---

## ACT 实验 (PushT)

| 实验ID | 日期 | 父实验 | 步数 | dim_model | n_dec | chunk_size | n_action | 成功率 | avg_sum | avg_max | 状态 | 备注 |
|--------|------|--------|------|-----------|-------|------------|----------|--------|---------|---------|------|------|
| act_001 | 2026-01-10 | - | 5k | 512 | 1 | **10** | **10** | ~2% | ~109 | - | 完成 | 基线 |
| act_002 | 2026-01-10 | act_001 | 20k | 512 | 1 | **10** | **10** | 10% | 99.9 | 65.2% | 完成 | 增加步数 |
| act_003 | 2026-01-10 | act_001 | 20k | 512 | **2** | **10** | **10** | 2% | 116.3 | 65.8% | 完成 | 加深decoder |
| act_004 | 2026-01-10 | act_001 | 20k | **1024** | **2** | **10** | **10** | 14% | 102.4 | 71.2% | 完成 | 加宽+加深 |
| **act_005** | 2026-01-10 | act_004 | 20k | **1024** | **4** | **10** | **10** | **24%** | 95.5 | 71.6% | 完成 | **🏆 最优** |
| ~~act_batch_01~~ | 2026-01-11 | - | 100k | 512 | 1 | ~~100~~ | 10 | 0% | 17.25 | 7.7% | 失败 | ❌ chunk_size 错误！|
| ~~act_batch_02~~ | 2026-01-11 | - | 50k | 1024 | 4 | ~~100~~ | 10 | 0% | 14.97 | 5.7% | 失败 | ❌ chunk_size 错误！|
| ~~act_batch_03~~ | 2026-01-11 | - | 100k | 1024 | 4 | ~~100~~ | 10 | 0% | 23.21 | 7.9% | 失败 | ❌ chunk_size 错误！|

### 关键发现 (ACT)

1. ⚠️ **chunk_size=10 极其关键！** 绝对不能改成 100！
2. `dim_model=1024` 优于 `dim_model=512`
3. `n_decoder_layers=4` 是最优值
4. 更多训练 (50k+) 可能进一步提升

### 关键参数 (ACT)

```yaml
# 没有明确实验目的时，绝对不要修改这些参数：
chunk_size: 10        # 预测1秒的动作序列
n_action_steps: 10    # 必须与 chunk_size 匹配
```

---

## 失败实验记录

| 日期 | 问题 | 根本原因 | 教训 |
|------|------|----------|------|
| 2026-01-12 | 10个ACT实验全部0%成功率 | chunk_size从10改成了100 | 设置参数前必须先查阅 experiment_registry.md |

---

## 下一步实验计划

- [ ] ACT 50k步, chunk_size=10, dim=1024, dec=4（延长SOTA训练）
- [ ] Diffusion 200k步（测试性能天花板）
- [ ] ACT chunk_size=20（对照实验）

---

## 归档规范

每个实验必须包含以下文件：

| 文件 | 说明 | 必须 |
|------|------|------|
| `config.yaml` | 参数配置 | ✅ |
| `metadata.yaml` | 环境元数据、代码版本 | ✅ |
| `run_train.sh` | 训练启动脚本 | ✅ |
| `run_eval.sh` | 评估启动脚本 | ✅ |
| `train_snapshot.py` | 训练代码快照 | ✅ |
| `eval_snapshot.py` | 评估代码快照 | ✅ |
| `train.log` | 训练日志 | ✅ |
| `eval.log` | 评估日志 | ✅ |
| `eval_result.json` | 评估结果 | ✅ |
| `model.safetensors` | 模型权重 | ✅ |
| `notes.md` | 实验结论 | ✅ |

### 代码追溯

- 每个实验对应一个 git 分支: `exp/exp_NNN_name`
- 训练完成后自动创建分支
- 通过 `git checkout exp/exp_NNN_name` 可恢复当时代码

---

*Last Updated: 2026-01-12*
*Protocol Version: CNEP v1.1*
